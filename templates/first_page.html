<html>
<!DOCTYPE html>
<html>
<head>
    <title>First Page Summary</title>
    <style>
        @page { 
            size: A4 portrait; 
            margin: 15mm;
        }
        * { box-sizing: border-box; }
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            font-size: 12pt;
            line-height: 1.3;
        }
        .container {
            width: 100%;
            max-width: 180mm;
            margin: 0 auto;
        }
        .header { 
            text-align: center; 
            margin-bottom: 20px;
            page-break-inside: avoid;
        }
        .title { 
            font-size: 18pt; 
            font-weight: bold; 
            margin-bottom: 10px;
        }
        .subtitle { 
            font-size: 14pt; 
            margin: 5px 0; 
        }
        h3 {
            font-size: 14pt;
            font-weight: bold;
            margin: 15px 0 10px 0;
            page-break-inside: avoid;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            page-break-inside: avoid;
        }
        thead { 
            display: table-header-group;
            page-break-inside: avoid;
        }
        tbody {
            page-break-inside: avoid;
        }
        tr {
            page-break-inside: avoid;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            font-size: 11pt;
            vertical-align: top;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        th {
            font-size: 10pt;
            text-align: center;
            vertical-align: middle;
            background-color: #f0f0f0;
            font-weight: bold;
            padding: 6px;
        }
        .description {
            text-align: left;
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
        }
        .amount { 
            text-align: right;
            font-family: monospace;
        }
        .info-table td {
            font-size: 12pt;
            padding: 8px;
        }
        .work-table th {
            font-size: 9pt;
            padding: 4px;
            line-height: 1.2;
        }
        .work-table td {
            font-size: 10pt;
            padding: 6px;
        }
        .total-row {
            font-weight: bold;
            background-color: #f8f9fa;
        }
        .grand-total {
            font-weight: bold;
            background-color: #e8f5e9;
        }
        @media print {
            .container { margin: 0; }
            table { page-break-inside: avoid; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="title">CONTRACTOR BILL</div>
        </div>
        
        <h3>Project Information</h3>
        <table class="info-table">
            <tr><td style="width: 35%;"><strong>Project Name:</strong></td><td>{{ title_data.get('Name of Work ;-', 'N/A') }}</td></tr>
            <tr><td><strong>Contract No:</strong></td><td>{{ title_data.get('Agreement No.', 'N/A') }}</td></tr>
            <tr><td><strong>Work Order No:</strong></td><td>{{ title_data.get('Reference to work order or Agreement :', 'N/A') }}</td></tr>
            <tr><td><strong>Contractor:</strong></td><td>{{ title_data.get('Name of Contractor or supplier :', 'N/A') }}</td></tr>
            <tr><td><strong>Bill Number:</strong></td><td>{{ title_data.get('Bill Number', 'N/A') }}</td></tr>
            <tr><td><strong>Bill Type:</strong></td><td>{{ title_data.get('Running or Final', 'N/A') }}</td></tr>
        </table>
        
        <h3>Work Items Summary</h3>
        <table class="work-table">
            <thead>
                <tr>
                    <th style="width: 10.06mm;">Unit</th>
                    <th style="width: 13.76mm;">Qty Since</th>
                    <th style="width: 13.76mm;">Qty Upto</th>
                    <th style="width: 9.55mm;">S.No.</th>
                    <th style="width: 63.83mm;">Description</th>
                    <th style="width: 13.16mm;">Rate</th>
                    <th style="width: 19.53mm;">Amount Upto</th>
                    <th style="width: 15.15mm;">Amount Since</th>
                    <th style="width: 11.96mm;">Remarks</th>
                </tr>
            </thead>
            <tbody>
{% for item in work_items %}
                <tr>
                    <td>{{ item.unit }}</td>
                    <td class="amount">{{ "%.2f"|format(item.quantity_since) if item.quantity_since > 0 else "" }}</td>
                    <td class="amount">{{ "%.2f"|format(item.quantity_upto) if item.quantity_upto > 0 else "" }}</td>
                    <td style="text-align: center;">{{ item.item_no }}</td>
                    <td class="description">{{ item.description }}</td>
                    <td class="amount">{{ "%.2f"|format(item.rate) if item.rate > 0 else "" }}</td>
                    <td class="amount">{{ "%.2f"|format(item.amount_upto) if item.amount_upto > 0 else "" }}</td>
                    <td class="amount">{{ "%.2f"|format(item.amount_since) if item.amount_since > 0 else "" }}</td>
                    <td>{{ item.remark }}</td>
                </tr>
{% endfor %}
                <tr class="total-row">
                    <td colspan="6">TOTAL</td>
                    <td class="amount">{{ "%.2f"|format(total_amount) }}</td>
                    <td class="amount">{{ "%.2f"|format(total_amount) }}</td>
                    <td></td>
                </tr>
{% if tender_premium_percent > 0 %}
                <tr class="total-row">
                    <td colspan="6">Tender Premium @ {{ "%.2f%%"|format(tender_premium_percent) }}</td>
                    <td class="amount">{{ "%.2f"|format(premium_amount) }}</td>
                    <td class="amount">{{ "%.2f"|format(premium_amount) }}</td>
                    <td></td>
                </tr>
{% endif %}
                <tr class="grand-total">
                    <td colspan="6">GRAND TOTAL</td>
                    <td class="amount">{{ "%.2f"|format(grand_total) }}</td>
                    <td class="amount">{{ "%.2f"|format(grand_total) }}</td>
                    <td></td>
                </tr>
            </tbody>
        </table>
        
{% if extra_items %}
        <h3>Extra Items Summary</h3>
        <table class="work-table">
            <thead>
                <tr>
                    <th style="width: 15mm;">Unit</th>
                    <th style="width: 18mm;">Quantity</th>
                    <th style="width: 12mm;">Item No.</th>
                    <th style="width: 65mm;">Description</th>
                    <th style="width: 18mm;">Rate</th>
                    <th style="width: 20mm;">Amount</th>
                    <th style="width: 22mm;">Remark</th>
                </tr>
            </thead>
            <tbody>
{% for item in extra_items %}
                <tr>
                    <td>{{ item.unit }}</td>
                    <td class="amount">{{ "%.2f"|format(item.quantity) if item.quantity > 0 else "" }}</td>
                    <td style="text-align: center;">{{ item.item_no }}</td>
                    <td class="description">{{ item.description }}</td>
                    <td class="amount">{{ "%.2f"|format(item.rate) if item.rate > 0 else "" }}</td>
                    <td class="amount">{{ "%.2f"|format(item.amount) if item.amount > 0 else "" }}</td>
                    <td>{{ item.remark }}</td>
                </tr>
{% endfor %}
                <tr class="total-row">
                    <td colspan="5">Extra Items Total</td>
                    <td class="amount">{{ "%.2f"|format(extra_total) }}</td>
                    <td></td>
                </tr>
{% if tender_premium_percent > 0 %}
                <tr class="total-row">
                    <td colspan="5">Extra Items Premium @ {{ "%.2f%%"|format(tender_premium_percent) }}</td>
                    <td class="amount">{{ "%.2f"|format(extra_premium) }}</td>
                    <td></td>
                </tr>
{% endif %}
                <tr class="grand-total">
                    <td colspan="5">Extra Items Grand Total</td>
                    <td class="amount">{{ "%.2f"|format(extra_grand_total) }}</td>
                    <td></td>
                </tr>
            </tbody>
        </table>
{% endif %}
        
        <div style="margin-top: 30px; text-align: center; font-size: 11pt; color: #666;">
            Generated on: {{ current_date }}
        </div>
    </div>
</body>
</html>